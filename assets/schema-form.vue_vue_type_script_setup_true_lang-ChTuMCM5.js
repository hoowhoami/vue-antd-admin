import{c as v,u as t,d as ae,k as V,F as se,I as De,a as be,G as fe,_ as K,w as pe,m as Ee,A as We,W as C,X as $,Y as N,au as Z,af as te,a5 as Se,Z as z,a6 as we,ak as oe,ad as G,ag as Ke,am as Ae,ae as me,y as Ne,aw as qe,ac as Ue,ah as Ge,f as ke,r as ve,J as ze,K as He,av as Be,H as Ye,ax as Je}from"./vue-nPfkdNmw.js";import{aO as Pe,ay as x,K as Ce,aP as Xe,i as L,aQ as ee,aR as ne,ai as he,aS as Ze,af as Qe,aa as Re,S as et,aT as Le,aU as tt,as as nt,D as st,aV as ot,aW as J,aX as Ie,aY as Me,aZ as at,a_ as Te,a$ as rt,b0 as ct}from"./antdv-BbttoKUq.js";import{c as lt,s as it,a as ut,b as dt,d as ft}from"./ApiSelect.vue_vue_type_script_setup_true_lang-BEJgt-SP.js";import{h as Fe,C as mt,D as pt,_ as $e}from"./index-BGRhdYbt.js";import{i as X}from"./is-DIFaXsjl.js";import{d as Oe}from"./index-5akZo7rI.js";import{d as _e}from"./dateUtil-D7gJQxXe.js";function ht(l,y){return v(()=>{const r=t(l),{labelCol:m={},wrapperCol:p={}}=r.formItemProps||{},{labelWidth:h,disabledLabelWidth:S}=r,{labelWidth:w,labelCol:k,wrapperCol:B,layout:I}=t(y);if(!w&&!h&&!k||S)return m.style={textAlign:"left"},{labelCol:m,wrapperCol:p};let i=h||w;const P={...k,...m},R={...B,...p};return i&&(i=Pe(i)?`${i}px`:i),{labelCol:{style:{width:i},...P},wrapperCol:{style:{width:I==="vertical"?"100%":`calc(100% - ${i})`},...R}}})}function je(l,y=""){const{t:r}=Fe();if(l.includes("Input")||l.includes("Complete"))return`${r("common.inputText")}${y}`;const m=["Select","Cascader","Checkbox","CheckboxGroup","Switch","TreeSelect"];return l.includes("Picker")||m.includes(l)?`${r("common.chooseText")}${y}`:""}const yt=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function gt(){return[...yt,"RangePicker"]}function bt(l,y){return l&&["Input","InputPassword","InputSearch","InputTextArea"].includes(l)&&y&&Pe(y)?`${y}`:y}const vt=gt(),Ve=Symbol("schema-form");async function St(l){mt(Ve,l)}function re(l={}){return pt(Ve,l)}const wt={formModel:{type:Object,default:()=>({})},schema:{type:Object,default:()=>({})},tableInstance:{type:Object},tableRowKey:{type:[String,Number]}};function At(l,y="default",r){if(!l||!Reflect.has(l,y))return null;if(!x(l[y]))return console.error(`${y} is not a function!`),null;const m=l[y];return m?m(r):null}const Pt={maxWidth:{type:String,default:"600px"},showIndex:{type:Boolean},color:{type:String,default:"#ffffff"},fontSize:{type:String,default:"14px"},placement:{type:String,default:"right"},text:{type:[Array,String]}},Rt=ae({name:"BasicHelp",components:{Tooltip:Ce},props:Pt,setup(l,{slots:y}){const r=v(()=>({color:l.color,fontSize:l.fontSize})),m=v(()=>({maxWidth:l.maxWidth}));function p(){const h=l.text;return L(h)?V("p",null,[h]):ee(h)?h.map((S,w)=>V("p",{key:S},[V(se,null,[l.showIndex?`${w+1}. `:"",S])])):null}return()=>V(Ce,{overlayClassName:"basic-help__wrap",title:V("div",{style:t(r)},[p()]),autoAdjustOverflow:!0,overlayStyle:t(m),placement:l.placement},{default:()=>[V("span",{class:"basic-help"},[At(y)||V(Xe,null,null)])]})}}),Ft={class:"mr-[6px]"},xt={class:"ml-[6px]"},kt=ae({name:"SchemaFormItem",__name:"schema-form-item",props:wt,emits:["update:formModel"],setup(l,{emit:y}){const r=l,m=y,p=re(),{formPropsRef:h,setItemRef:S,updateSchema:w,getSchemaByField:k,appendSchemaByField:B}=p,{t:I}=Fe(),{schema:i}=De(r),P=ht(i,h),R=v(()=>ee(i.value.field)?i.value.field:i.value.field.split(".")),f=v({get(){return R.value.reduce((s,o)=>s==null?void 0:s[o],r.formModel)},set(s){const o=i.value.field.split("."),e=o.pop(),n=o.reduce((a,c)=>a[c]??(a[c]={}),r.formModel);n[e]=s,m("update:formModel",r.formModel)}}),b=v(()=>{const{component:s,componentProps:o}=i.value;if(!x(o)&&(o!=null&&o.vModelKey))return o.vModelKey;const e=L(s)&&["Switch","Checkbox"].includes(s),n=s==="Upload";return{true:"value",[`${e}`]:"checked",[`${n}`]:"file-list"}.true}),g=v(()=>{const{formModel:s,schema:o,tableInstance:e}=r,{mergeDynamicData:n}=t(h);return{field:o.field,formInstance:p,tableInstance:e,tableRowKey:r.tableRowKey,formModel:r.tableRowKey?s[r.tableRowKey]:s,values:{...n,...s},schema:v(()=>r.schema)}}),M=v(()=>{const{vShow:s,vIf:o,isAdvanced:e=!1}=t(i),{showAdvancedButton:n}=t(h),a=n&&ne(e)?e:!0;let c=!0,d=!0;return ne(s)&&(c=s),ne(o)&&(d=o),x(s)&&(c=s(t(g))),x(o)&&(d=o(t(g))),c=c&&a,{isShow:c,isIfShow:d}}),W=v(()=>{const{disabled:s}=t(h),{dynamicDisabled:o}=r.schema,{disabled:e=!1}=t(H);let n=!!s||e;return ne(o)&&(n=o),x(o)&&(n=o(t(g))),n}),A=(s,o=t(g))=>{if(L(s))return V(se,null,[s]);if(be(s))return s;if(x(s))return A(s(o));if(s&&X(s)){const e=Object.keys(s);return e.some(n=>n.startsWith("_")||["setup","render"].includes(n))?s:e.reduce((n,a)=>(n[a]=(...c)=>A(s[a],...c),n),{})}return s},T=v(()=>{const s=r.schema.component;return L(s)?lt[s]??A(s):A(s)}),D=v(()=>{const s=r.schema.componentSlots??{};return L(s)||be(s)?{default:(...o)=>A(s,o)}:A(s)}),O=v(()=>{const s=r.schema.label;return x(s)?s(t(g)):s}),H=v(()=>{const{schema:s}=r;let{componentProps:o={},component:e}=s;return x(o)&&(o=o(t(g))??{}),e!=="RangePicker"&&L(e)&&(o.placeholder??(o.placeholder=je(e,O.value))),s.component==="Divider"&&(o=Object.assign({type:"horizontal"},o,{orientation:"left",plain:!0})),be(T.value)&&Object.assign(o,T.value.props),o}),ce=v(()=>{const s=H.value;return Object.keys(s).reduce((o,e)=>{if(/^on([A-Z])/.test(e)){const n=e.replace(/^on([A-Z])/,"$1").toLocaleLowerCase();o[n]=s[e]}return o},{})}),le=v(()=>{const{helpMessage:s,helpComponentProps:o,subLabel:e}=r.schema,n=e?V("span",null,[O.value,fe(" "),V("span",{class:"text-secondary"},[e])]):A(O.value),a=x(s)?s(t(g)):s;return!a||Array.isArray(a)&&a.length===0?n:V("span",null,[n,V(Rt,K({placement:"top",class:"mx-1",text:a},o),null)])});function ye(s,o,e){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(o)?s.type=e?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(o)?s.type="array":["InputNumber"].includes(o)&&(s.type="number")}const ge=v(()=>{var xe;const{rules:s=[],component:o,rulesMessageJoinLabel:e,dynamicRules:n,required:a}=r.schema;if(x(n))return n(t(g));let c=he(s);const{rulesMessageJoinLabel:d}=t(h),u=Reflect.has(t(h),"rulesMessageJoinLabel")?e:d,F=L(o)?`${je(o,O.value)}${u?O.value:""}`:void 0;function _(U,E){const de=U.message||F;return E===void 0||tt(E)||Array.isArray(E)&&E.length===0||typeof E=="string"&&E.trim()===""||typeof E=="object"&&Reflect.has(E,"checked")&&Reflect.has(E,"halfChecked")&&Array.isArray(E.checked)&&Array.isArray(E.halfChecked)&&E.checked.length===0&&E.halfChecked.length===0?Promise.reject(de):Promise.resolve()}const j=x(a)?a(t(g)):a;(!c||c.length===0)&&j&&(c=[{required:j,validator:_}]);const q=c.findIndex(U=>Reflect.has(U,"required")&&!Reflect.has(U,"validator"));if(q!==-1){const U=c[q];if(o&&L(o)){Reflect.has(U,"type")||(U.type=o==="InputNumber"?"number":"string"),U.message=U.message||F,(o.includes("Input")||o.includes("Textarea"))&&(U.whitespace=!0);const E=(xe=t(H))==null?void 0:xe.valueFormat;ye(U,o,E)}}const Y=c.findIndex(U=>U.max);return Y!==-1&&!c[Y].validator&&(c[Y].message=c[Y].message||I("component.form.maxTip",[c[Y].max])),c}),ie=async s=>{try{const o=Object.assign(i.value,{loading:!0,componentProps:{...t(H),options:[]}});w(o);const e=await s(t(g)),{component:n}=t(i),a=o.componentProps;["Select","RadioGroup","CheckBoxGroup"].some(c=>c===n)?a.options=e:["TreeSelect","Tree"].some(c=>c===n)&&(a.treeData=e),o.componentProps&&(o.componentProps.requestResult=e),o.loading=!1,w(o)}finally{await Ne(),i.value.loading=!1}},ue=()=>{const s=H.value.request;if(s)if(x(s))ie(s);else{const{watchFields:o=[],options:e={},wait:n=0,callback:a}=s,c=o.map(d=>()=>r.formModel[d]);pe(c,nt(()=>{ie(a)},n),{...e})}};return pe(M,(s,o)=>{!Ze(s,o)&&s.isIfShow&&s.isShow&&(k(r.schema.field)||B(r.schema),ue())},{immediate:!0}),(s,o)=>M.value.isIfShow?Ee((C(),$(t(Le),Z(K({key:0},t(i).colProps)),{default:N(()=>[t(i).component==="Divider"?(C(),$(t(Qe),Z(K({key:0},Object.assign(H.value))),{default:N(()=>[(C(),$(te(le.value)))]),_:1},16)):(C(),$(t(Re).Item,K({key:1},{...t(i).formItemProps,...t(P)},{label:le.value,name:R.value,rules:ge.value}),{default:N(()=>[t(i).beforeSlot?(C(),Se(se,{key:0},[t(L)(t(i).beforeSlot)?z(s.$slots,t(i).beforeSlot,Z(K({key:0},g.value)),()=>[we("span",Ft,oe(t(i).beforeSlot),1)],!0):G("",!0),t(x)(t(i).beforeSlot)?(C(),$(te(t(i).beforeSlot(g.value)),{key:1})):G("",!0)],64)):G("",!0),t(i).slot?z(s.$slots,t(i).slot,Z(K({key:1},g.value)),void 0,!0):T.value?(C(),$(te(T.value),K({key:2,ref:t(S)(t(i).field)},H.value,{[b.value]:f.value,["onUpdate:"+b.value]:o[0]||(o[0]=e=>f.value=e),"allow-clear":!0,disabled:W.value,loading:t(i).loading},Ke(ce.value)),Ae({_:2},[Object.is(t(i).loading,!0)?{name:"notFoundContent",fn:N(()=>[V(t(et),{size:"small"})]),key:"0"}:void 0,me(D.value,(e,n)=>({name:n,fn:N(a=>[(C(),$(te((e==null?void 0:e({...g.value,slotData:a}))??e),{key:n}))])}))]),1040,["disabled","loading"])):G("",!0),t(i).afterSlot?(C(),Se(se,{key:3},[t(L)(t(i).afterSlot)?z(s.$slots,t(i).afterSlot,Z(K({key:0},g.value)),()=>[we("span",xt,oe(t(i).afterSlot),1)],!0):G("",!0),t(x)(t(i).afterSlot)?(C(),$(te(t(i).afterSlot(g.value)),{key:1})):G("",!0)],64)):G("",!0)]),_:3},16,["label","name","rules"]))]),_:3},16)),[[We,M.value.isShow]]):G("",!0)}}),Bt=$e(kt,[["__scopeId","data-v-fd7061db"]]),Ct=ae({__name:"index",props:{expand:{type:Boolean}},setup(l){qe(m=>({"4cf09dcc":r.value}));const y=l,r=v(()=>`${y.expand?0:.5}turn`);return(m,p)=>(C(),$(t(st),{class:"collapse-icon"}))}}),It=$e(Ct,[["__scopeId","data-v-af0a3cde"]]),Mt=ae({name:"FormAction",inheritAttrs:!1,__name:"form-action",props:{showActionButtonGroup:{type:Boolean,default:!0},showResetButton:{type:Boolean,default:!0},showSubmitButton:{type:Boolean,default:!0},showAdvancedButton:{type:Boolean,default:!0},resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:{type:Number,default:6},isAdvanced:Boolean,hideAdvanceBtn:Boolean},emits:["toggle-advanced"],setup(l,{emit:y}){const r=y,m=l,{t:p}=Fe(),{resetFields:h,submit:S}=re(),w=v(()=>{const{showAdvancedButton:P,actionSpan:R,actionColOptions:f}=m,b=24-R,g=P?{span:b<6?24:b}:{};return{style:{textAlign:"right"},span:P?6:4,...g,...f}}),k=v(()=>Object.assign({text:p("common.resetText")},m.resetButtonOptions)),B=v(()=>Object.assign({text:p("common.queryText")},m.submitButtonOptions));function I(){r("toggle-advanced",m.isAdvanced)}const i=async P=>{await S(P).catch(()=>{})};return(P,R)=>{const f=Ue("a-button");return l.showActionButtonGroup?(C(),$(t(Le),Z(K({key:0},w.value)),{default:N(()=>[we("div",{style:Ge([{width:"100%"},{textAlign:w.value.style.textAlign}])},[V(t(Re).Item,null,{default:N(()=>[z(P.$slots,"resetBefore"),l.showResetButton?(C(),$(f,K({key:0,type:"default",class:"mr-2"},k.value,{onClick:t(h)}),{default:N(()=>[fe(oe(k.value.text),1)]),_:1},16,["onClick"])):G("",!0),z(P.$slots,"submitBefore"),l.showSubmitButton?(C(),$(f,K({key:1,type:"primary",class:"mr-2"},B.value,{onClick:R[0]||(R[0]=b=>i(b))}),{default:N(()=>[fe(oe(B.value.text),1)]),_:1},16)):G("",!0),z(P.$slots,"advanceBefore"),l.showAdvancedButton&&!l.hideAdvanceBtn?(C(),$(f,{key:2,type:"link",size:"small",onClick:I},{default:N(()=>[fe(oe(l.isAdvanced?t(p)("component.form.putAway"):t(p)("component.form.unfold"))+" ",1),V(t(It),{class:"ml-1",expand:!l.isAdvanced},null,8,["expand"])]),_:1})):G("",!0),z(P.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):G("",!0)}}}),Tt=({props:l,attrs:y})=>{const r=ke(he(l)),m=ve({...l.initialValues}),p=ve({...l.initialValues}),h=ke(),S={...l.initialValues},w=new Map,k=new Map,B=ve({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),I=v(()=>({...y,...r.value})),i=v(()=>{const{baseRowStyle:R={},rowProps:f}=t(I);return{style:R,...f}}),P=v(()=>({...I.value,...B}));return pe(()=>r.value.schemas,()=>{var R;(R=r.value.schemas)==null||R.forEach(f=>{!k.has(f.field)&&x(f.componentProps)&&k.set(f.field,f.componentProps),ot(f.defaultValue)||J(p,f.field,f.defaultValue)})}),{formModel:m,defaultFormValues:p,schemaFormRef:h,formPropsRef:r,cacheFormModel:S,compRefMap:w,getFormProps:I,advanceState:B,getRowConfig:i,getFormActionBindProps:P,originComponentPropsFnMap:k,formSchemasRef:v(()=>t(r).schemas||[])}};function Ot(){const l=re(),{emit:y,getFormProps:r,schemaFormRef:m}=l;async function p(h){var k;(k=h==null?void 0:h.preventDefault)==null||k.call(h);const{submitFunc:S}=t(r);if(S&&x(S)){await S();return}if(t(m))try{const B=await l.validate(),I=l.handleFormValues(B);return y("submit",I),I}catch(B){return Promise.reject(B)}}return{submit:p}}const _t=()=>{const l=re(),{compRefMap:y,formModel:r,formPropsRef:m,cacheFormModel:p,schemaFormRef:h,getFormProps:S,formSchemasRef:w,defaultFormValues:k,originComponentPropsFnMap:B,emit:I}=l,i=e=>n=>{n&&y.set(e,n)};function P(){return t(h)?ue(ze(t(r))):{}}function R(e){var n;return(n=t(m).schemas)==null?void 0:n.some(a=>a.field===e&&L(a.component)?vt.includes(a.component):!1)}async function f(e){const n=t(w),a=n.map(d=>d.field).filter(Boolean);Object.assign(p,e);const c=[];Object.entries(e).forEach(([d,u])=>{const F=n.find(j=>j.field===d),_=Reflect.has(e,d);if(L(F==null?void 0:F.component)&&(u=bt(F==null?void 0:F.component,u)),_&&a.includes(d)){if(R(d))if(Array.isArray(u)){const j=[];for(const q of u)j.push(q?Ie(q):null);J(r,d,j)}else{const{componentProps:j}=F||{};let q=j;x(j)&&(q=q({formPropsRef:m,formModel:r})),J(r,d,u?q!=null&&q.valueFormat?u:Ie(u):null)}else J(r,d,u);c.push(d)}}),await O(c).catch(d=>{})}async function b(e){let n=[];X(e)&&n.push(e),ee(e)&&(n=[...e]),t(m).schemas=n}async function g(e,n,a=!1){const c=he(t(w)),d=c.findIndex(u=>u.field===n);if(!n||d===-1||a){a?c.unshift(e):c.push(e),m.value.schemas=c;return}d!==-1&&c.splice(d+1,0,e),m.value.schemas=c,T(m.value.schemas)}async function M(e){const n=he(t(w));if(!e)return;let a=L(e)?[e]:e;L(e)&&(a=[e]);for(const c of a)if(L(c)){const d=n.findIndex(u=>u.field===c);d!==-1&&(Me(r,c),n.splice(d,1))}m.value.schemas=n}function W(e){return t(w).find(n=>e===n.field)}const A=e=>{let n=[];if(X(e)&&n.push(e),ee(e)&&(n=[...e]),!n.every(u=>u.component==="Divider"||Reflect.has(u,"field")&&u.field)){console.error("All children of the form Schema array that need to be updated must contain the `field` field");return}const c=[],d=[];t(w).forEach(u=>{const F=n.find(_=>u.field===_.field);if(F){const _=F.componentProps,j=Oe(u,F);if(B.has(u.field)){const q=B.get(u.field);j.componentProps=Y=>({...q(Y),...x(_)?_(Y):_})}d.push(j),c.push(j)}else c.push(u)}),T(d),m.value.schemas=at(c,"field")};function T(e){let n=[];X(e)&&n.push(e),ee(e)&&(n=[...e]);const a={},c=P();n.forEach(d=>{d.component!="Divider"&&Reflect.has(d,"field")&&d.field&&!Te(d.defaultValue)&&(!(d.field in c)||Te(c[d.field]))&&(a[d.field]=d.defaultValue)}),f(a)}async function D(){const{resetFunc:e,submitOnReset:n}=t(S);x(e)&&await e(),Object.keys(r).forEach(a=>{J(r,a,k[a])}),I("reset",r),n&&l.submit(),setTimeout(ce)}async function O(e){var n;return(n=h.value)==null?void 0:n.validateFields(e)}async function H(e){return await h.value.validate(e)}async function ce(e){var n;await((n=h.value)==null?void 0:n.clearValidate(e))}async function le(e,n){var a;await((a=h.value)==null?void 0:a.scrollToField(e,n))}const ye=(e,n)=>{var c;J(r,e,n),J(p,e,n);const{validateTrigger:a}=t(S);(!a||a==="change")&&((c=h.value)==null||c.validateFields([e]))},ge=e=>Me(r,e),ie=e=>{const{schemas:n}=m.value;m.value=Oe(t(m)||{},e),m.value.schemas=n!=null&&n.length?n:e.schemas};function ue(e){var a,c;if(!X(e))return{};const n={};for(let[d,u]of Object.entries(e)){if(!d||ee(u)&&u.length===0||x(u))continue;const{transformDateFunc:F}=t(S);X(u)&&(u=F==null?void 0:F(u)),ee(u)&&((a=u[0])!=null&&a.format)&&((c=u[1])!=null&&c.format)&&(u=u.map(j=>F==null?void 0:F(j))),L(u)&&(u=u.trim());const _=W(d);if(x(_==null?void 0:_.transform)&&(u=_==null?void 0:_.transform(u),X(u))){Object.assign(n,u),Reflect.deleteProperty(n,d);continue}J(n,d,u)}return s(n)}function s(e){const n=t(S).fieldMapToTime;if(!n||!Array.isArray(n))return e;for(const[a,[c,d],u="YYYY-MM-DD"]of n){if(!a||!c||!d||!e[a])continue;const[F,_]=e[a];e[c]=_e(F).format(u),e[d]=_e(_).format(u),Reflect.deleteProperty(e,a)}return e}return{setItemRef:i,clearValidate:ce,validate:H,validateFields:O,getFieldsValue:P,updateSchema:A,resetSchema:b,getSchemaByField:W,appendSchemaByField:g,removeSchemaByField:M,resetFields:D,setFieldsValue:f,scrollToField:le,setDefaultValue:T,setFormModel:ye,delFormModel:ge,setSchemaFormProps:ie,handleFormValues:ue,handleEnterPress:e=>{const{autoSubmitOnEnter:n}=t(m);if(n&&e.key==="Enter"&&e.target&&e.target instanceof HTMLElement){const a=e.target;a&&a.tagName&&a.tagName.toUpperCase()=="INPUT"&&l.submit(e)}}}};let jt,Lt,$t;function Vt(){return{screenRef:v(()=>t(jt)),widthRef:Lt,screenEnum:it,realWidthRef:$t}}const Q=24,Dt=()=>{const l=re(),{realWidthRef:y,screenEnum:r,screenRef:m}=Vt(),{advanceState:p,getFormProps:h,formSchemasRef:S,formModel:w,defaultFormValues:k,emit:B}=l,I=v(()=>{if(!p.isAdvanced)return 0;const f=t(h).emptySpan||0;if(Pe(f))return f;if(X(f)){const{span:b=0}=f,g=t(m);return f[g.toLowerCase()]||b||0}return 0});pe([S,()=>p.isAdvanced,()=>t(y)],()=>{const{showAdvancedButton:f}=t(h);f&&P()},{immediate:!0});function i(f,b=0,g=!1){const M=t(y),W=parseInt(f.md)||parseInt(f.xs)||parseInt(f.sm)||f.span||Q,A=parseInt(f.lg)||W,T=parseInt(f.xl)||A,D=parseInt(f.xxl)||T;return M<=r.LG?b+=W:M<r.XL?b+=A:M<r.XXL?b+=T:b+=D,g?(p.hideAdvanceBtn=!1,b<=Q*2?(p.hideAdvanceBtn=!0,p.isAdvanced=!0):b>Q*2&&b<=Q*(t(h).autoAdvancedLine||3)?p.hideAdvanceBtn=!1:p.isLoad||(p.isLoad=!0,p.isAdvanced=!p.isAdvanced),{isAdvanced:p.isAdvanced,itemColSum:b}):b>Q*(t(h).alwaysShowLines||1)?{isAdvanced:p.isAdvanced,itemColSum:b}:{isAdvanced:!0,itemColSum:b}}function P(){let f=0,b=0;const{baseColProps:g={}}=t(h);for(const M of t(S)){const{vShow:W,colProps:A}=M;let T=!0;if(ne(W)&&(T=W),x(W)&&(T=W({schema:v(()=>t(S).find(D=>D.field===M.field)),formModel:w,field:M.field,formInstance:l,values:{...t(k),...w}})),T&&(A||g)){const{itemColSum:D,isAdvanced:O}=i({...g,...A},f);f=D||0,O&&(b=f),M.isAdvanced=O}}p.actionSpan=b%Q+t(I),i(t(h).actionColOptions||{span:Q},f,!0),B("advanced-change")}function R(){p.isAdvanced=!p.isAdvanced}return{handleToggleAdvanced:R}},zt=ae({name:"SchemaForm",__name:"schema-form",props:ut,emits:dt,setup(l,{expose:y,emit:r}){const m=l,p=r,h=He(),S=Tt({props:m,attrs:h}),{formModel:w,getRowConfig:k,schemaFormRef:B,getFormProps:I,getFormActionBindProps:i,formSchemasRef:P}=S,R={...S,emit:p};St(R);const f=_t(),{handleEnterPress:b,setDefaultValue:g}=f,M=Ot(),{handleToggleAdvanced:W}=Dt();return Object.assign(R,{...S,...M,...f}),p("register",R),y(R),g(P.value),(A,T)=>(C(),$(t(Re),K({ref_key:"schemaFormRef",ref:B},t(ct)(t(I),t(ft)),{model:t(w),onKeypress:Je(t(b),["enter"])}),{default:N(()=>[V(t(rt),Z(Be(t(k))),{default:N(()=>[z(A.$slots,"formHeader"),z(A.$slots,"default",{},()=>[(C(!0),Se(se,null,me(t(P),D=>(C(),$(Bt,{key:D.field,"form-model":t(w),"onUpdate:formModel":T[0]||(T[0]=O=>Ye(w)?w.value=O:null),schema:D,"table-instance":A.tableInstance},Ae({_:2},[me(Object.keys(A.$slots),O=>({name:O,fn:N(H=>[z(A.$slots,O,K({ref_for:!0},H||{}))])}))]),1032,["form-model","schema","table-instance"]))),128)),A.showActionButtonGroup?(C(),$(Mt,K({key:0},t(i),{onToggleAdvanced:t(W)}),Ae({_:2},[me(["resetBefore","submitBefore","advanceBefore","advanceAfter"],D=>({name:D,fn:N(O=>[z(A.$slots,D,Z(Be(O||{})))])}))]),1040,["onToggleAdvanced"])):G("",!0)]),z(A.$slots,"formFooter")]),_:3},16)]),_:3},16,["model","onKeypress"]))}});export{Bt as S,zt as _,Rt as a,wt as s};
