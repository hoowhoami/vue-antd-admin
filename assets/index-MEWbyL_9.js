import{g as c,f as y,t as C}from"./columns-BXE9GvFZ.js";import{aq as k,ar as T,as as q,U as E,e as P,ae as F,al as p,ac as O}from"./antdv-BbttoKUq.js";import{k as l,G as d,d as R,f as U,c as V,W as j,a5 as D,Y as n,u as i}from"./vue-nPfkdNmw.js";import{u as N}from"./dynamic-table-3ORtHQM3.js";import"./index-BGRhdYbt.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-BEJgt-SP.js";import{w as g}from"./common-CDMIWo2L.js";import"./schema-form.vue_vue_type_script_setup_true_lang-ChTuMCM5.js";import"./is-DIFaXsjl.js";import"./index-5akZo7rI.js";import"./dateUtil-D7gJQxXe.js";const B=[{title:"姓名",dataIndex:"name",sorter:!0,defaultEditable:!0,editable:({index:e})=>e>0,formItemProps:{defaultValue:"李白",rules:[{required:!0,message:"请输入姓名"}]},editFormItemProps:{extendSearchFormProps:!1,rules:[{required:!0,message:"请输入姓名"}]}},{title:"性别",dataIndex:"gender",formItemProps:{component:"Select",componentProps:({formInstance:e,formModel:a})=>({options:[{label:"男",value:1},{label:"女",value:0}],onChange(){e==null||e.updateSchema({field:"clothes",componentProps:{options:c(a.gender)}}),a.clothes=""}})},editFormItemProps:{extendSearchFormProps:!0,rules:[{required:!0,type:"number",message:"请选择性别"}],componentProps:({formInstance:e,formModel:a,tableRowKey:o})=>({onChange(){e==null||e.updateSchema({field:`${o}.clothes`,componentProps:{options:c(a.gender)}}),a.clothes=""}})},customRender:({record:e})=>["女","男"][e.gender]},{title:"衣服",dataIndex:"clothes",formItemProps:{component:"Select",componentProps:({formModel:e})=>({options:c(e.gender)})}},{title:"图片",dataIndex:"img",hideInSearch:!0,formItemProps:{component:"Upload",defaultValue:[{uid:"-1",name:"image.png",status:"done",url:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png"}],componentProps:{maxCount:1,listType:"picture-card",action:"https://www.mocky.io/v2/5cc8019d300000980a055e76"},componentSlots:({formModel:e})=>({default:()=>{var a;return(a=e.img)!=null&&a.length?"":l("div",null,[l(k,null,null),l("div",{class:"mt-8px"},[d("Upload")])])}})},customRender:({record:e})=>l(T,{width:100,src:e.img},null)},{title:"价格",dataIndex:"price",editFormItemProps:{component:"InputNumber",rules:[{required:!0,message:"请输入价格！"}]},customRender:({record:e})=>`${e.price}元`},{title:"状态",dataIndex:"status",formItemProps:{component:"Select",componentProps:({formInstance:e,schema:a})=>({showSearch:!0,filterOption:!1,request:()=>y(),onSearch:q(async o=>{a.value.loading=!0;const u={field:a.value.field,componentProps:{options:[]}};e==null||e.updateSchema([u]);const m=await y(o).finally(()=>a.value.loading=!1);u.componentProps.options=m,e==null||e.updateSchema([u])},500),onChange(o){e.setFieldsValue({status:o})}})},editFormItemProps:{rules:[{required:!0,type:"number",message:"请选择状态"}]},customRender:({record:e})=>l(E,{color:e.status==1?"red":"default"},{default:()=>[["已售罄","热卖中"][e.status]]})}],L=R({name:"EditRowTable",__name:"index",setup(e){const[a]=N(),o=U("cell"),u=async t=>(await g(500),{...t,items:C}),m=V(()=>[...B,{title:"操作",hideInTable:o.value==="cell",width:200,dataIndex:"ACTION",actions:({record:t},s)=>{const{startEditable:r,cancelEditable:h,isEditable:S,getEditFormModel:x,validateRow:_}=s;return S(t.id)?[{label:"保存",onClick:async()=>{var v;const b=await _(t.id);P.loading({content:"保存中...",key:t.id}),x(t.id),await g(2e3),h(t.id),P.success({content:"保存成功!",key:t.id,duration:2}),Object.assign(t,{...b,img:((v=b.img[0])==null?void 0:v.thumbUrl)||t.img})}},{label:"取消",onClick:()=>{h(t.id)}}]:[{label:"编辑",onClick:()=>{r(t.id,t)}}]}}]),w=(t,s,r)=>{},f=async(t,s,r)=>{await g(2e3),Object.assign(r,s)};return(t,s)=>(j(),D("div",null,[l(i(F),{message:"可编辑行表格",type:"info","show-icon":""},{description:n(()=>[d(" 可编辑行表格-可编辑行表格使用示例 ")]),_:1}),l(i(O),{title:"可编辑行表格基本使用示例",style:{"margin-top":"20px"}},{default:n(()=>[l(i(a),{size:"small",bordered:"","data-request":u,columns:m.value,"editable-type":o.value,"on-save":f,"on-cancel":w,"row-key":"id"},{toolbar:n(()=>[l(i(p),{ref:"select",value:o.value,"onUpdate:value":s[0]||(s[0]=r=>o.value=r)},{default:n(()=>[l(i(p).Option,{value:"single"},{default:n(()=>[d("单行编辑")]),_:1}),l(i(p).Option,{value:"multiple"},{default:n(()=>[d("多行编辑")]),_:1}),l(i(p).Option,{value:"cell"},{default:n(()=>[d("可编辑单元格")]),_:1})]),_:1},8,["value"])]),_:1},8,["columns","editable-type"])]),_:1})]))}});export{L as default};
